{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar css = function css(props) {\n  var color = 'yellow';\n\n  if (props.color) {\n    color = props.color;\n  }\n\n  return \"\\n        .popup {\\n          position: absolute;\\n          visibility: hidden;\\n          z-index: 9999999999;\\n          will-change: transform;\\n          top: 0px;\\n          left: 0px;\\n          transform: translate3d(0px, 0px, 0px);\\n          width: auto;\\n          display:block;\\n          background-color: #000;\\n          color: #FFF;\\n          text-align: center;\\n          border-radius: 6px;\\n          padding: 10px;\\n          margin-left: -80px;\\n          line-height: 20px;\\n          font-size: 14px;\\n          border: 4px solid rgb(0, 0, 0);\\n          box-shadow: rgba(0, 0, 0, 0.1) 1px 1px 2px 0px;\\n         }\\n        .popup::after {\\n          content: \\\"\\\";\\n          position: absolute;\\n          width: 0;\\n          height: 0;\\n          border-width: 10px;\\n          border-style: solid;\\n          border-color: #000 transparent transparent transparent;\\n          top: 44px;\\n          left: 50%;\\n          margin-left:-12px;\\n          \\n        }\\n        .popupItem{width:auto; padding:8px 12px; font-size:16px; font-weight:bold; border-right:1px solid #433E49; cursor:pointer;}\\n        .popupItem:hover{text-decoration:underline; color:#1890ff;}\\n        .popupItem:last-child{border-right:none}\\n        .extracted-class {\\n        position: relative;\\n    display: inline-block;\\n    }\\n        .extracted-class::after {\\n          background:  \".concat(color, \";\\n          content: \\\"\\\";\\n          display: block;\\n          position: absolute;\\n          z-index: 999;\\n          left: 0;\\n          right: 0;\\n          opacity: 0.3;\\n          top: 0;\\n          bottom: 0;\\n        }\\n        \\n        .extracted-simple-text {\\n          background-color: \").concat(color, \";\\n          color: black;\\n        }\\n        \");\n};\n\nvar PopOver =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PopOver, _Component);\n\n  function PopOver(props) {\n    var _this;\n\n    _classCallCheck(this, PopOver);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PopOver).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"parseItems\", function (items) {\n      if (items != null && items != undefined && items.length > 0) {\n        if (!Array.isArray(items)) items = [items];\n        var parsed = '';\n        items.forEach(function (item, index) {\n          var handler = \"<span class='popupItem' data-action=\\\"\".concat(index, \"\\\"  id=\\\"\").concat(item.text, \"-\").concat(index, \"\\\">\\n            \").concat(item.text, \"\\n          </span>\");\n          parsed += handler;\n        });\n        return parsed;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"selectionEndText\", function (e) {\n      var t = document.getSelection();\n\n      if (t.toString().length !== 0) {\n        _this.range = t.getRangeAt(0);\n\n        if (_this.range && !_this.range.collapsed) {\n          _this.frangment = _this.range.cloneContents();\n        }\n\n        var top = 0;\n        if (e.pageY < _this.state.startY) top = e.pageY - 50;else top = _this.state.startY - 50;\n        var left = 0;\n\n        if (_this.state.startX > e.pageX) {\n          left = _this.state.startX;\n        } else {\n          left = e.pageX;\n        }\n\n        var popup = document.querySelector('#popup-dynamic');\n\n        if (popup) {\n          popup.style.visibility = 'visible';\n          popup.style.transform = \"translate3d(\".concat(left, \"px, \").concat(top, \"px, 0px)\");\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"processSelection\", function (e) {\n      var t = document.getSelection();\n\n      if (t.toString().length !== 0 && e.target.classList.contains('popupItem')) {\n        if (_this.frangment) {\n          if (_this.props.colorText) {\n            var span = document.createElement('span');\n\n            try {\n              span.className = 'extracted-simple-text';\n\n              _this.range.surroundContents(span);\n            } catch (error) {\n              console.log(error);\n              var ansector = _this.range.commonAncestorContainer;\n              var tagCollection = [];\n\n              if (ansector.nodeType != 3) {\n                tagCollection = Array.from(ansector.querySelectorAll('*'));\n              }\n\n              span.className = '';\n\n              if (_this.frangment && _this.frangment.childNodes && _this.frangment.childNodes.length) {\n                _this.frangment.childNodes.forEach(function (child, i) {\n                  tagCollection.forEach(function (tag) {\n                    if (child.nodeType === 3 && child.nodeName == '#text' && tag.innerHTML.includes(child.textContent)) {\n                      var spanWrapper = document.createElement('span');\n                      spanWrapper.className = 'extracted-simple-text';\n                      spanWrapper.append(child.textContent);\n                      var Html = tag.innerHTML.replace(child.textContent, spanWrapper.innerHTML);\n                      tag.innerHTML = Html;\n                    } else if (tag.innerHTML && tag.innerHTML.includes(child.innerHTML)) {\n                      var _spanWrapper = document.createElement('span');\n\n                      _spanWrapper.className = 'extracted-simple-text';\n\n                      _spanWrapper.append(child.textContent);\n\n                      var _Html = tag.innerHTML.replace(child.innerHTML, _spanWrapper.outerHTML);\n\n                      tag.innerHTML = _Html;\n                    }\n                  });\n                });\n              }\n            }\n          }\n\n          var frangmentWrapper = document.createElement('span');\n          frangmentWrapper.appendChild(_this.frangment);\n\n          _this.props.events[e.target.dataset.action].handler(frangmentWrapper, _this.range.toString());\n\n          if (window.getSelection) {\n            window.getSelection().removeAllRanges();\n          } else if (document.selection) {\n            document.selection.empty();\n          }\n        }\n      } else {\n        _this.setState({\n          startX: e.pageX,\n          startY: e.pageY\n        });\n      }\n\n      _this.hidePopup();\n    });\n\n    _this.state = {\n      startX: 0,\n      startY: 0\n    };\n    _this.el = document.createElement('span');\n    _this.range = null;\n    _this.frangment = null;\n    return _this;\n  }\n\n  _createClass(PopOver, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var style = document.createElement('style');\n      style.type = 'text/css';\n\n      if (style.styleSheet) {\n        style.styleSheet.cssText += css(this.props);\n      } else {\n        style.appendChild(document.createTextNode(css(this.props)));\n      }\n\n      this.el.appendChild(style);\n      var span = document.createElement('span');\n      var parseItems = this.parseItems(this.props.events);\n      span.innerHTML = \"<span class='popup' id=\\\"popup-dynamic\\\" >\\n          \".concat(parseItems, \"\\n        </span>\");\n      this.el.appendChild(span);\n      document.body.appendChild(this.el);\n      document.onmouseup = this.selectionEndText;\n      document.onmousedown = this.processSelection;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.body.removeChild(this.el);\n      this.range = null;\n      this.frangment = null;\n    }\n  }, {\n    key: \"hidePopup\",\n    value: function hidePopup() {\n      var popup = document.querySelector('#popup-dynamic');\n\n      if (popup) {\n        popup.style.visibility = 'hidden';\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return null;\n    }\n  }]);\n\n  return PopOver;\n}(_react.Component);\n\nvar _default = PopOver;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}